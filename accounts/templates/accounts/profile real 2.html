<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로필</title>
</head>
<style>
    /* 기본 스타일 설정 */
    /* profile.html 스타일 */
    body {
        background-color: #000; /* 배경 검정색 */
        color: #fff; /* 글씨 흰색 */
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    
    .container {
        width: 80%;
        margin: auto;
        padding: 20px;
    }
    
    /* 버튼 스타일 */
    button {
        background-color: #444;
        color: white;
        border: none;
        padding: 10px 15px;
        cursor: pointer;
        border-radius: 5px;
    }
    
    button:hover {
        background-color: #666;
    }
    
</style>
<body>
    <h1>{{ profile_data.username }}의 프로필</h1>
    <header>
        <div>
            <a href="/"><button>메인</button></a>
            <span id="current-time"></span>
        </div>
        <div>
            <button id="edit-profile-btn" onclick="window.location.href='/accounts/profileedit/'">프로필 수정</button>
            <button id="change-password-btn" onclick="window.location.href='/accounts/profile/passwordchange/'">비밀번호 변경</button>
            <button id="logout-btn" onclick="logout()">로그아웃</button>
        </div>
    </header>

    <main>
        <div class="profile-header">
            <img src="{{ profile_data.profile_image }}" alt="프로필 사진" id="profile-image">
            <div>
                <p id="user-name">{{ profile_data.username }}</p>
                <p id="user-email">{{ profile_data.email }}</p>
            </div>
        </div>

        <!-- 팔로워/팔로잉 정보 -->
        <div class="user-follow">
            <h3>팔로워</h3>
            <ul>
                {% for follower in profile_data.followers %}
                    <li>{{ follower.username }}</li>
                {% empty %}
                    <p>팔로워가 없습니다.</p>
                {% endfor %}
            </ul>
            <p><strong>팔로워 수:</strong> {{ profile_data.follower_count }}</p>

            <h3>팔로잉</h3>
            <ul>
                {% for following in profile_data.followings %}
                    <li>{{ following.username }}</li>
                {% empty %}
                    <p>팔로잉이 없습니다.</p>
                {% endfor %}
            </ul>
            <p><strong>팔로잉 수:</strong> {{ profile_data.following_count }}</p>
        </div>

        <!-- 좋아요한 게시글 섹션 -->
        <div class="user-posts">
            <h3>좋아요한 게시글</h3>
            <ul id="post-list">
                {% for article in profile_data.Favorite_articles %}
                    <li>
                           <a href="/articles/{{ article.id }}/">
                            <strong>{{ article.Article_title }}</strong>: {{ article.movie_title }} (작성자: {{ article.author_username }})
                        </a>
                    </li>
                {% empty %}
                    <p>좋아요한 게시글이 없습니다.</p>
                {% endfor %}
            </ul>
            <p><strong>좋아요한 게시글 수:</strong> {{ profile_data.Favorite_articles_count }}</p>
        </div>

        <!-- 좋아요한 댓글 섹션 -->
        <div class="user-comments">
            <h3>좋아요한 댓글</h3>
            <ul id="comment-list">
                {% for comment in profile_data.Favorite_comments %}
                    <li>
                        <!-- 좋아요한 댓글이 달린 게시글로 이동 -->
                        <a href="/articles/{{ comment.article.id }}/#comments">
                            <strong>{{ comment.Article_title }}</strong>: {{ comment.content }} (작성자: {{ comment.author_username }})
                        </a>
                    </li>
                {% empty %}
                    <p>좋아요한 댓글이 없습니다.</p>
                {% endfor %}
            </ul>
            <p><strong>좋아요한 댓글 수:</strong> {{ profile_data.Favorite_comments_count }}</p>
        </div>

        <!-- AI 대화 기록 섹션 -->
        <div class="user-ai-conversations">
            <h3>AI와 나눈 대화</h3>
            <ul id="ai-conversation-list">
                {% for conversation in profile_data.bot_Conversation_List %}
                    <li>
                        <strong>질문:</strong> {{ conversation.user_question }} <br>
                        <strong>답변:</strong> {{ conversation.bot_response }}
                    </li>
                {% empty %}
                    <p>AI와의 대화가 없습니다.</p>
                {% endfor %}
            </ul>
        </div>
<!-- 작성한 댓글 섹션 -->
<div class="user-comments">
    <h3>작성한 댓글</h3>
    <ul id="comment-list">
        {% for comment in profile_data.written_comments %}
            <li>
                <!-- 작성한 댓글이 달린 게시글로 이동 -->
                <a href="/articles/{{ article.id }}/">
                    <strong>{{ comment.Article_title }}</strong>: {{ comment.content }} (작성자: {{ comment.author_username }})
                </a>
            </li>
        {% empty %}
            <p>작성한 댓글이 없습니다.</p>
        {% endfor %}
    </ul>
    <p><strong>작성한 댓글 수:</strong> {{ profile_data.written_comments_count }}</p>
</div>

        <!-- 작성한 게시글 섹션 -->
        <div class="user-posts">
            <h3>작성한 게시글</h3>
            <ul id="post-list">
                {% for article in profile_data.written_articles %}
                    <li>
                        <a href="/articles/{{ article.id }}/">
                            <strong>{{ article.Article_title }}</strong>: {{ article.movie_title }} (작성자: {{ article.author_username }})
                        </a>
                    </li>
                {% empty %}
                    <p>작성한 게시글이 없습니다.</p>
                {% endfor %}
            </ul>
            <p><strong>작성한 게시글 수:</strong> {{ profile_data.written_articles_count }}</p>
        </div>
    </main>

    <script>
        // 로그아웃 함수
        function logout() {
            localStorage.removeItem('token');  // 로컬 스토리지에서 토큰 제거
            window.location.href = '/login/';  // 로그인 페이지로 리다이렉트
        }

        // 현재 시간 표시
        setInterval(() => {
            document.getElementById('current-time').textContent = new Date().toLocaleString();
        }, 1000);
    </script>
</body>
</html>
